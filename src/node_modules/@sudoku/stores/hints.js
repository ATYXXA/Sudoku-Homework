import { settings } from './settings.js';
import { get, writable } from 'svelte/store';
import { candidates } from './candidates.js';

export const usedHints = writable(0);

function createHints() {
	const defaultHints = 0; // 默认不提示

	const hints = writable(0);

	settings.subscribe(($settings) => {
		hints.set(0);
        candidates.clear();
	});

	return {
		subscribe: hints.subscribe,

		useHint() {     // hint 不应超出settings.gethints()的范围
			hints.update($hints => {
                let curHintLevel = settings.gethints();
                console.log("settings.hints: ", curHintLevel);
                let newHints = ($hints + 1 > curHintLevel ? 0 : $hints + 1);
				return newHints;
			});
		},

        gethints(){
            let currentValue;
            hints.subscribe($hints => {
              currentValue = $hints;
            });
            return currentValue;
        },

		reset() {
			hints.set(defaultHints);
			usedHints.set(0);
		}
	};
}

export const hints = createHints();