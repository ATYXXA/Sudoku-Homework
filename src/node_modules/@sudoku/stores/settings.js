import { DEFAULT_SETTINGS } from '@sudoku/constants';
import { writable } from 'svelte/store';

function createSettings() {
	const settings = writable((() => {
		const storedSettings = localStorage.getItem('settings');

		if (storedSettings) {
			return JSON.parse(storedSettings);
		}

		return DEFAULT_SETTINGS;
	})());

	return {
		subscribe: settings.subscribe,
        
        gethints(){
            return DEFAULT_SETTINGS.hints;
        },

		set(newSettings) {
            console.log("set: ", newSettings);
			settings.set(newSettings);
			const newSettingsJson = JSON.stringify(newSettings);
            const newSettingsObj = JSON.parse(newSettingsJson);
            Object.keys(newSettingsObj).forEach(key => {
                if (DEFAULT_SETTINGS.hasOwnProperty(key)) {
                    DEFAULT_SETTINGS[key] = newSettingsObj[key];
                }
            });
            console.log("settings hints3: ", DEFAULT_SETTINGS.hints);
		},
	};
}1

export const settings = createSettings();